angular.module("app").component("waterindex",{templateUrl:"app/modules/waterIndex/waterindex.html?rev=9f046256e8",controller:["$scope","$api","$q","$interval","$timeout","$state","$stateParams","$element",function(t,e,o,a,i,l,p,n){function s(t){$ctrl.pageIndex<t.length&&(t[$ctrl.pageIndex].id?e.business.monitor({devicetype:"ULTRACOLDWATERMETER",project:u,key:t[$ctrl.pageIndex].id,ext:{enableMask:1},mode:"SENSOR"},function(e){var o=e.result[u].detail[0];t[$ctrl.pageIndex].data=o,o?(t[$ctrl.pageIndex].name=o.title,!0===o.status?t[$ctrl.pageIndex].status=o.status:t[$ctrl.pageIndex].status=0,t[$ctrl.pageIndex].flow=o.channels["04"]?o.channels["04"].lasttotal:0,t[$ctrl.pageIndex].velocity=o.channels["09"]?o.channels["09"].lasttotal+" m³/h":"0 m³/h",t[$ctrl.pageIndex].temperature=o.channels["05"]?o.channels["05"].lasttotal+" ℃":"0 ℃",t[$ctrl.pageIndex].vauleId=o.channels["04"].id):t[$ctrl.pageIndex].status=1,$ctrl.pageIndex++,s(t)}):(t[$ctrl.pageIndex].status=1,$ctrl.pageIndex++,s(t)))}$ctrl=this;var u=APP.Project[0]._id;$ctrl.paramsIndex={i:"1",tit:"1#  变电所",img:["/app/img/water/index1.png?rev=a6cc8057f7","/app/img/water/index2.png?rev=332eee0fd2"]};var r=new Date,m=r.getFullYear(),f=r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,y=r.getDate()<10?"0"+r.getDate():r.getDate(),d=r.getDate()-1<10?"0"+(r.getDate()-1):r.getDate()-1,c=r.getHours()<10?"0"+r.getHours():r.getHours();String(m),String(m),new Date(m+"-"+f+"-"+y+" "+c+":00:00").getTime();$ctrl.event1={page_1:[{type:"b",name:"",id:"000068120453",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5%",left:"47.3%"},status:0},{type:"b",name:"",id:"79304026",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"21.5%",left:"0.7%"},status:0},{type:"b",name:"",id:"79304033",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"30%",left:"0.7%"},status:0},{type:"b",name:"",id:"79304011",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"9.3%"},status:0},{type:"b",name:"",id:"79304017",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.3%",left:"9.3%"},status:0},{type:"b",name:"",id:"73065369",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"28.6%",left:"9.3%"},status:0},{type:"b",name:"",id:"79304934",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"9.3%"},status:0},{type:"b",name:"",id:"79304032",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"17.4%"},status:0},{type:"b",name:"",id:"79304021",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"17.4%"},status:0},{type:"b",name:"",id:"79304035",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"17.4%"},status:0},{type:"b",name:"",id:"79304016",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"26.1%"},status:0},{type:"b",name:"",id:"79304027",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"26.1%"},status:0},{type:"b",name:"",id:"73065314",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"26.1%"},status:0},{type:"b",name:"",id:"79304007",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"34.2%"},status:0},{type:"b",name:"",id:"79234135",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"34.2%"},status:0},{type:"b",name:"",id:"78024727",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"34.2%"},status:0},{type:"b",name:"",id:"71564008",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"42.8%"},status:0},{type:"b",name:"",id:"71564016",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"42.8%"},status:0},{type:"b",name:"",id:"77215419",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"42.8%"},status:0},{type:"b",name:"",id:"79234138",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"51%"},status:0},{type:"b",name:"",id:"79234131",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"51%"},status:0},{type:"b",name:"",id:"78024729",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"51%"},status:0},{type:"b",name:"",id:"71564014",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"59.5%"},status:0},{type:"b",name:"",id:"79304008",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"59.5%"},status:0},{type:"b",name:"",id:"77215413",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"59.5%"},status:0},{type:"b",name:"",id:"79304003",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"67.8%"},status:0},{type:"b",name:"",id:"79304020",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"67.8%"},status:0},{type:"b",name:"",id:"77215416",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"67.8%"},status:0},{type:"b",name:"",id:"71564013",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"76.5%"},status:0},{type:"b",name:"",id:"71564007",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"76.5%"},status:0},{type:"b",name:"",id:"79234140",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"76.5%"},status:0},{type:"b",name:"",id:"79304012",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"21.5%",left:"84.5%"},status:0},{type:"b",name:"",id:"79304022",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"30%",left:"84.5%"},status:0},{type:"b",name:"",id:"79304013",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"17.8%",left:"93%"},status:0},{type:"b",name:"",id:"79304028",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"26%",left:"93%"},status:0},{type:"b",name:"",id:"79304019",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"34.2%",left:"93%"},status:0},{type:"b",name:"",id:"71564009",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"51.8%",left:"0.7%"},status:0},{type:"b",name:"",id:"79304004",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"60.5%",left:"0.7%"},status:0},{type:"b",name:"",id:"71564012",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"48%",left:"9.3%"},status:0},{type:"b",name:"",id:"79234133",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"56.2%",left:"9.3%"},status:0},{type:"b",name:"",id:"",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"64.4%",left:"9.3%"},status:1},{type:"b",name:"",id:"79304006",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"51.8%",left:"17.4%"},status:0},{type:"b",name:"",id:"79234132",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"60.5%",left:"17.4%"},status:0},{type:"b",name:"",id:"71564015",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"51.8%",left:"26.1%"},status:0},{type:"b",name:"",id:"79234136",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"60.5%",left:"26.1%"},status:0},{type:"b",name:"",id:"79304024",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"51.8%",left:"34.2%"},status:0},{type:"b",name:"",id:"79304036",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"60.5%",left:"34.2%"},status:0},{type:"d",name:"",id:"79304031",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"48%",left:"42.8%"},status:0},{type:"d",name:"",id:"79304005",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"56.2%",left:"42.8%"},status:0},{type:"d",name:"",id:"79304023",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"64.4%",left:"42.8%"},status:0},{type:"b",name:"",id:"77215408",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"51.8%",left:"51%"},status:0},{type:"b",name:"",id:"77215411",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"60.5%",left:"51%"},status:0},{type:"d",name:"",id:"77215407",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"51.8%",left:"59.5%"},status:0},{type:"d",name:"",id:"77215397",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"60.5%",left:"59.5%"},status:0},{type:"b",name:"",id:"78024744",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"48%",left:"67.8%"},status:0},{type:"d",name:"",id:"73065174",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"48%",left:"76.5%"},status:0},{type:"d",name:"",id:"73065177",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"64.4%",left:"67.8%"},status:0},{type:"d",name:"",id:"73085122",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"64.4%",left:"76.5%"},status:0},{type:"d",name:"",id:"73085132",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"48%",left:"84.5%"},status:0},{type:"d",name:"",id:"73065171",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"48%",left:"93%"},status:0},{type:"d",name:"",id:"73065181",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"64.4%",left:"84.5%"},status:0},{type:"d",name:"",id:"73085108",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"64.4%",left:"93%"},status:0},{type:"b",name:"",id:"77290416",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"0.7%"},status:0},{type:"b",name:"",id:"77290418",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"86.7%",left:"0.7%"},status:0},{type:"b",name:"",id:"77290418",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"0.7%"},status:0},{type:"d",name:"",id:"79304025",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"9.3%"},status:0},{type:"d",name:"",id:"79304009",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"9.3%"},status:0},{type:"d",name:"",id:"78024694",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"17.4%"},status:0},{type:"d",name:"",id:"",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"17.4%"},status:0},{type:"d",name:"",id:"79304018",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"26.1%"},status:0},{type:"d",name:"",id:"79304010",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"86.7%",left:"26.1%"},status:0},{type:"d",name:"",id:"79304015",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"26.1%"},status:0},{type:"b",name:"",id:"77290417",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"34.2%"},status:0},{type:"d",name:"",id:"77215390",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"34.2%"},status:0},{type:"d",name:"",id:"",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"42.8%"},status:0},{type:"d",name:"",id:"",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"42.8%"},status:0},{type:"d",name:"",id:"78024721",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"51%"},status:0},{type:"d",name:"",id:"77290419",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"51%"},status:0},{type:"b",name:"",id:"",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"59.5%"},status:0},{type:"b",name:"",id:"73085095",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"59.5%"},status:0},{type:"d",name:"",id:"73065183",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"67.8%"},status:0},{type:"d",name:"",id:"73065175",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"76.5%"},status:0},{type:"d",name:"",id:"73085118",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"67.8%"},status:0},{type:"d",name:"",id:"",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"76.5%"},status:0},{type:"d",name:"",id:"79304034",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"84.5%"},status:0},{type:"d",name:"",id:"79304014",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"78.5%",left:"93%"},status:0},{type:"d",name:"",id:"79234134",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94.8%",left:"93%"},status:0}],page_2:[{type:"b",name:"",id:"000068120453",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"0%",left:"50.4%"},status:0},{type:"b",name:"",id:"78024699",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"0.8%"},status:0},{type:"b",name:"",id:"73065155",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"14.3%",left:"0.8%"},status:0},{type:"b",name:"",id:"78024698",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"0.8%"},status:0},{type:"b",name:"",id:"78024743",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"9.5%"},status:0},{type:"b",name:"",id:"78024717",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"14.3%",left:"9.5%"},status:0},{type:"b",name:"",id:"78024749",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"9.5%"},status:0},{type:"b",name:"",id:"78024738",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"18%"},status:0},{type:"d",name:"",id:"78024728",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"18%"},status:0},{type:"b",name:"",id:"78024713",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"25.8%"},status:0},{type:"b",name:"",id:"78024703",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"25.8%"},status:0},{type:"b",name:"",id:"78024748",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"34.4%"},status:0},{type:"b",name:"",id:"151114467",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"34.4%"},status:0},{type:"b",name:"",id:"78024740",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"42.3%"},status:0},{type:"b",name:"",id:"78024742",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"42.3%"},status:0},{type:"b",name:"",id:"78024700",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"51%"},status:0},{type:"b",name:"",id:"79234130",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"59.2%"},status:0},{type:"b",name:"",id:"79234137",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"59.2%"},status:0},{type:"b",name:"",id:"77215402",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"67.9%"},status:0},{type:"b",name:"",id:"78024722",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"67.9%"},status:0},{type:"b",name:"",id:"78024708",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"76.5%"},status:0},{type:"d",name:"",id:"78024750",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"85%"},status:0},{type:"b",name:"",id:"78024711",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"76.5%"},status:0},{type:"d",name:"",id:"78024710",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"85%"},status:0},{type:"d",name:"",id:"151114309",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"5.3%",left:"93%"},status:0},{type:"d",name:"",id:"151114319",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"23.1%",left:"93%"},status:0},{type:"b",name:"",id:"78024718",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"0.8%"},status:0},{type:"b",name:"",id:"78024751",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"44.7%",left:"0.8%"},status:0},{type:"b",name:"",id:"78024709",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"0.8%"},status:0},{type:"b",name:"",id:"78024714",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"62.3%",left:"0.8%"},status:0},{type:"b",name:"",id:"78024695",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"9.5%"},status:0},{type:"b",name:"",id:"78024702",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"44.7%",left:"9.5%"},status:0},{type:"b",name:"",id:"78024746",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"9.5%"},status:0},{type:"b",name:"",id:"78024693",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"62.3%",left:"9.5%"},status:0},{type:"b",name:"",id:"78024697",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"18%"},status:0},{type:"b",name:"",id:"78024707",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"44.7%",left:"18%"},status:0},{type:"b",name:"",id:"78024712",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"18%"},status:0},{type:"b",name:"",id:"78024715",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"25.8%"},status:0},{type:"d",name:"",id:"78024745",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"34.4%"},status:0},{type:"b",name:"",id:"78024716",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"42.3%"},status:0},{type:"d",name:"",id:"78024701",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"51%"},status:0},{type:"d",name:"",id:"78024719",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"25.8%"},status:0},{type:"d",name:"",id:"78024705",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"34.4%"},status:0},{type:"d",name:"",id:"78024711",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"42.3%"},status:0},{type:"d",name:"",id:"78024704",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"51%"},status:0},{type:"b",name:"",id:"77215393",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"59.2%"},status:0},{type:"b",name:"",id:"77215391",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"44.7%",left:"59.2%"},status:0},{type:"b",name:"",id:"151114333",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"59.2%"},status:0},{type:"b",name:"",id:"151114331",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"67.9%"},status:0},{type:"b",name:"",id:"78024736",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"44.7%",left:"67.9%"},status:0},{type:"b",name:"",id:"78024741",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"67.9%"},status:0},{type:"d",name:"",id:"77215404",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"76.5%"},status:0},{type:"d",name:"",id:"77215386",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"44.7%",left:"76.5%"},status:0},{type:"d",name:"",id:"78024737",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"53.5%",left:"76.5%"},status:0},{type:"d",name:"",id:"78024739",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"35.7%",left:"85%"},status:0},{type:"d",name:"",id:"7096807",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"80.4%",left:"0.8%"},status:0},{type:"d",name:"",id:"7096743",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"90%",left:"0.8%"},status:0},{type:"b",name:"",id:"79234139",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"9.5%"},status:0},{type:"b",name:"",id:"151114463",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"85.3%",left:"9.5%"},status:0},{type:"b",name:"",id:"151114474",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"94%",left:"9.5%"},status:0},{type:"b",name:"",id:"151114447",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"18%"},status:0},{type:"b",name:"",id:"151114449",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"85.3%",left:"18%"},status:0},{type:"b",name:"",id:"79034002",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"25.8%"},status:0},{type:"b",name:"",id:"151114441",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"85.3%",left:"25.8%"},status:0},{type:"b",name:"",id:"151114471",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"34.4%"},status:0},{type:"b",name:"",id:"151114430",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"85.3%",left:"34.4%"},status:0},{type:"b",name:"",id:"79304037",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"42.3%"},status:0},{type:"d",name:"",id:"77215400",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"51%"},status:0},{type:"d",name:"",id:"73085039",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"67.9%"},status:0},{type:"d",name:"",id:"77215395",flow:"",velocity:"",temperature:"",value:"0.0",position:{top:"76.3%",left:"85%"},status:0}]},$ctrl.getS=function(t){$ctrl.eventPage=t,$ctrl.pageIndex=0,$ctrl.pageIndex2=0,s(t)}}]}),angular.module("app").component("channedetail",{templateUrl:"app/modules/waterIndex/channedetail.html?rev=73c4035fa7",bindings:{curve:"=",channels:"<"},controller:["$scope","$element","$api","$timeout",function(t,e,o,a){var i=this,l=e.find(".modal-curve");$ctrl.apiFun=function(t){i.api=t,l.modal("show"),i.channeldetail(i.api)},i.date=moment().format("YYYY-MM-DD"),i.timetype={DAY:"日",WEEK:"周",MONTH:"月",YEAR:"年"},i.timetype_current="DAY",i.timetypeChange=function(t){i.timetype_current=t,i.channeldetail(i.api)},i.currentchannelid="04",i.changeId=function(t){i.currentchannelid=t,i.channeldetail(i.api)},i.queryBtn=function(){i.channeldetail(i.api)},i.channeldetail=function(t){i.type=i.type||"diff",i.categories=[],i.diff=[],i.scale=[],i.enable=!1,i.channelID=[],i.charttype="column",i.title=t.title,o.business.channeldetail({id:t.channels[i.currentchannelid].id,timeformat:i.timetype_current,from:i.date.replace(/-/g,""),to:i.date.replace(/-/g,"")},function(t){if(t.result){for(index in t.result.detail)i.categories.push(t.result.detail[index].timepoint),i.diff.push(t.result.detail[index].value),i.scale.push(t.result.detail[index].total);i.unit=t.result.unit,i.buildLine()}})},i.lineType=function(t){i.type=t,i.buildLine()},i.typeChange=function(t){i.charttype=t,i.buildLine()},i.buildLine=function(){i.timeline={chart:{type:i.charttype},title:!1,xAxis:{type:"datetime",categories:i.categories,labels:{formatter:function(){return moment(this.value).format({DAY:"H",WEEK:"M-DD",MONTH:"M-DD",YEAR:"YYYY-MM"}[i.timetype_current])}}},yAxis:{title:!1},tooltip:{xDateFormat:"%m月%d日",pointFormat:'{series.name}: <span style="color:{point.color};font-weight:700;">{point.y:.2f} '+i.unit+"</span>"},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y:.2f}"+i.unit}}},series:[{name:i.title,data:i[i.type]}],exporting:{enabled:!1}}}}]}),angular.module("app").component("graph",{templateUrl:"app/modules/waterIndex/graph.html?rev=c016df30fb",bindings:{curve:"=",channels:"<"},controller:["$scope","$element","$api","$timeout",function(t,e,o,a){function l(t,e){var o=new Date(t),a=o.getFullYear(),i=o.getMonth()+1<10?"0"+(o.getMonth()+1):o.getMonth()+1,l=o.getDate()<10?"0"+o.getDate():o.getDate(),p=o.getHours()<10?"0"+o.getHours():o.getHours();switch(e){case"DAY":return l+"日"+p+":00";case"MONTH":return i+"月"+l+"日";case"YEAR":return a+"年"+i+"月"}}var p=this,n=e.find(".graph-curve"),s=APP.Project[0]._id;$ctrl.apiFun2=function(t){p.api=t,n.modal("show"),p.changeId2()},p.date=moment().format("YYYY-MM-DD"),p.timetype={DAY:"日",MONTH:"月",YEAR:"年"},p.timetype_current="DAY",p.timetypeChange=function(t){p.timetype_current=t,p.channeldetail(p.api)},p.currentchannelid={currentchannelid1:!0,currentchannelid2:!1,currentchannelid3:!1,currentchannelid4:!1,currentchannelid5:!1},p.changeId2=function(t){var e=[];p.currentchannelid.currentchannelid1&&e.push($ctrl.allData.id),p.currentchannelid.currentchannelid2&&e.push($ctrl.totalTableData.id),p.currentchannelid.currentchannelid3&&e.push($ctrl.table2Data.id),p.currentchannelid.currentchannelid4&&e.push($ctrl.table3Data.id),p.currentchannelid.currentchannelid5&&e.push($ctrl.waterBalanceData.id),p.api=e,p.channeldetail(p.api)},p.queryBtn=function(){p.channeldetail(p.api)},p.channeldetail=function(t){p.type=p.type||"diff",p.categories=[],p.diff=[],p.scale=[],p.enable=!1,p.channelID=[],p.charttype="column",p.deviceType=[],p.id=t,o.eca.analysis({detail:!0,nodes:p.id,projectid:s,timefrom:p.date.replace(/-/g,""),timeto:p.date.replace(/-/g,""),timetype:p.timetype_current},function(t){for(i in t.result){if(p.diff=[],t.result[i].data)for(index in t.result[i].data.usage)"DAY"==p.timetype_current&&(timeX=l(t.result[i].data.usage[index].timepoint,"DAY"),p.categories.push(timeX)),"MONTH"==p.timetype_current&&(timeX=l(t.result[i].data.usage[index].timepoint,"MONTH"),p.categories.push(timeX)),"YEAR"==p.timetype_current&&(timeX=l(t.result[i].data.usage[index].timepoint,"YEAR"),p.categories.push(timeX)),p.diff.push(t.result[i].data.usage[index].value);else p.diff=[];p.deviceType.push({name:t.result[i].title,data:p.diff}),p.buildLine()}})},p.lineType=function(t){p.type=t,p.buildLine()},p.typeChange=function(t){p.charttype=t,p.buildLine()},p.buildLine=function(){p.timeline={chart:{type:p.charttype,backgroundColor:"rgba(0, 0, 0, 0)",height:700},title:!1,xAxis:{categories:p.categories,labels:{style:{color:"#000"}}},yAxis:{title:!1,labels:{style:{color:"#000"}}},tooltip:{formatter:function(){switch(this.series.name){case"水":" m³";break;case"电":case"冷热度":" Wkh"}return"<b>"+this.x+"</b><br>"+this.series.name+': <span style="color:#333;font-weight:700;">'+this.y+"m³</span>"}},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0}}},legend:{itemStyle:{color:"#000"},itemHoverStyle:{color:"#000"}},series:p.deviceType,exporting:{enabled:!1}}}}]});