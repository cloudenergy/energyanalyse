angular.module("app").component("map",{templateUrl:"app/modules/map/map.html?rev=e9a7252679",controller:["$api","$q","$rootScope","$interval","$timeout","$scope","$element",function(e,t,o,r,n,l,a){function i(e){var t=new Date;t.setDate(t.getDate()+e);var o=t.getFullYear(),r=t.getMonth()+1,n=t.getDate();return String(o)+String(r<10&&"0"+r||r)+String(n<10&&"0"+n||n)}var p=this;i(0),i(-1),i(-2);p.showchart=!1;var s,c=(ol.proj.get("EPSG:4326"),[0,0]),u=[.7031250000029744,.3515625000014872,.1757812499888463,.08789062499442316,.04394531250910888,.021972656242657134,.010986328121328567,.00549316407256159,.0027465820243834896,.0013732910240890498,.0006866455120445249,.0003433227441249574,.00017166138395978374,8583068008258684e-20,4291534004129342e-20,2145767002064671e-20,9658089455004757e-21,5364423453814192e-21,2682199829602067e-21],m=new ol.tilegrid.TileGrid({tileSize:256,origin:c,resolutions:u}),y=[361.2950134292628,-362.7919006363002,740.5416870148514,-181.85943603592554],g=new ol.layer.Tile({source:new ol.source.TileImage({tileGrid:m,tileUrlFunction:function(e,t,o){return"/app/img/map/3dmap/png"+e[0]+"/"+e[1]+","+(-e[2]-1)+".png"}})}),d=[new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0,0,0,0)"}),fill:new ol.style.Fill({color:"rgba(255, 0, 255, 0)"})})],w=[new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(0,0,0,0)"}),fill:new ol.style.Fill({color:"rgba(0, 0, 255, .5)"})})],f={type:"FeatureCollection",crs:{type:"name",properties:{name:"EPSG:4326"}},features:[{type:"Feature",id:"26455",properties:{name:"图书馆"},geometry:{type:"Polygon",coordinates:[[[639.827613789968,-332.48817441737947],[653.5842132153647,-336.1322021271092],[659.7877120553031,-327.06779477905155],[659.8024749337202,-323.4889983925599],[662.2798919257505,-324.15538785784963],[662.4045180854105,-322.95547483302346],[666.8670272404008,-316.72588346378984],[675.0209426451569,-306.3304137989221],[674.8135757018107,-294.7892761043419],[659.0457915841588,-290.05485532827515],[658.2276534616522,-291.07727048934305],[644.7542953082102,-287.2883605774741],[644.6152495928869,-285.80863950823203],[629.6693801480345,-281.5023422062592],[621.7674636446296,-293.4125518612652],[621.5655898653456,-305.0065612599436],[614.9950790015047,-302.8494643972875],[608.6848067851082,-311.9598769943657],[608.6394881815954,-323.6239242348365],[617.8175353611889,-326.60259244753814],[618.0479049290453,-330.37055967142015],[621.4368438326389,-331.4255904941071],[621.1168670260186,-332.8222274569091],[634.7797393396048,-336.4933776641957],[635.9103011681464,-335.09159086008543],[637.4401473594555,-335.42873380439994],[639.2995833944938,-333.31867215902605]]]}},{type:"Feature",id:"24256",properties:{name:"教三教学楼"},geometry:{type:"Polygon",coordinates:[[[555.7478713636625,-306.6919326587623],[555.7097625379813,-293.617858868088],[555.9981536512443,-293.4403610043297],[556.2144469861914,-293.51348875090713],[560.2907180430617,-287.71991727910677],[560.5674361826926,-287.22724912728256],[560.6635665537802,-286.9306182679264],[604.8746108624985,-299.95525358204134],[604.8694610211901,-313.1573867599146],[600.3369140244074,-320.1625442301732]]]}},{type:"Feature",id:"23610",properties:{name:"游泳馆"},geometry:{type:"Polygon",coordinates:[[[390.923221534701,-131.24227943291157],[390.994302298251,-127.21521812261732],[390.33614330853214,-126.69412891475852],[389.8847091755562,-126.01998184498616],[389.8687210955027,-125.05407777296338],[390.106709268019,-124.70529322402525],[390.26455337045815,-124.58166564959873],[388.7583132935695,-123.50445602663014],[387.1446373921174,-121.9549361152017],[387.6892504629849,-121.57549925991896],[389.51372461737185,-120.6038924332274],[390.9785178880071,-119.5280066640212],[392.36326892347006,-118.46647961639174],[393.5923143894946,-117.13346071256693],[394.53102854193594,-115.88547395424966],[395.47870416599966,-114.49389998016518],[395.7632308900093,-114.05519521028914],[397.2108140617335,-114.06120346967231],[398.22060897772485,-114.37017057083385],[399.9394803358348,-114.30133017518942],[401.5168011762735,-114.30214485442781],[401.9811683421589,-113.79836758038493],[403.10664771000245,-113.41893072510219],[404.0812077489332,-113.14794804343084],[405.4559789637258,-113.16821318948594],[406.6314592698258,-113.42667017786694],[407.6025569219934,-114.1952182043884],[408.13128374771213,-115.36143153415169],[408.16315807291437,-116.6190926084249],[408.98231804712117,-116.35299800218394],[409.5756082024827,-116.25421814452848],[410.59273523161966,-116.07264650927105],[411.94245505983156,-115.99464097219467],[412.89705545742163,-116.45106501550582],[413.6760924791374,-117.01268451547479],[414.0914770558144,-117.72848206131012],[414.3432129404786,-118.35201718339715],[414.31418999261075,-119.1952101951366],[414.4578790432828,-119.48299563609984],[415.62857310885727,-119.00070552696965],[417.0358296582809,-118.823818297333],[417.8957235944074,-118.85396142915364],[418.7497111060556,-119.09042207809797],[419.530479321153,-119.71283701623221],[419.9591024354539,-119.96324904713406],[420.31246955510795,-120.8447319830781],[420.57846232644414,-121.66501214123767],[420.51929624675563,-122.1786674010461],[421.42267368723157,-121.91287829951953],[422.2453978831063,-121.80269293252653],[423.3035643788774,-121.66226259880808],[424.2093858570685,-121.84953698873427],[425.26724684812524,-122.2153279667739],[426.05544901127297,-122.94171634270838],[426.37938584344,-123.74488823686164],[426.5694097757958,-124.66415192248628],[426.5080033282017,-125.16609616824277],[426.51645562530007,-125.45999170349398],[426.8472153960887,-125.78769642713861],[425.1739660753289,-127.48874667690863],[423.8766295658099,-128.62072580649357],[422.2729975334431,-129.92761144467147],[420.85046715961334,-131.0249848669607],[419.5494638835303,-132.45690198881414],[418.7265589734537,-133.2503950884165],[417.53569354084857,-134.28356315422369],[415.67023381694105,-135.9460188075389],[415.15946956781215,-136.39295317010672],[415.2032743919227,-136.772302946904],[414.6421971733868,-137.42386841638825],[415.091634668761,-137.7214909070593],[414.3702317939805,-138.53951470816355],[414.249956262637,-141.66154710084197],[406.4301693757038,-138.13313109705805],[404.77447218096563,-139.3327574944853],[399.3390444486894,-136.79858584137034],[399.09761728952014,-134.62148608307643]]]}},{type:"Feature",id:"23612",properties:{name:"羽毛球馆"},geometry:{type:"Polygon",coordinates:[[[436.00358112788143,-146.80834402526736],[432.3756979451075,-149.98492235893534],[417.6289224150899,-143.35816837368674],[416.4029801006663,-144.26370232900817],[414.318343383849,-143.18178241945296],[414.44395051457644,-138.4950255884831],[415.12097784888033,-137.75512516047277],[414.73399831416043,-137.54416276460927],[414.7981721898252,-137.2971486656065],[415.29579633776024,-136.65052310520844],[415.83196169263186,-136.01671387917446],[416.51307149081526,-135.33191592721718],[417.31948631346484,-134.53407606209177],[418.1067227364905,-133.85259744853096],[418.84887147963093,-132.82765951478152],[419.5124625473887,-132.14922362808412],[420.3967896185106,-131.2606551801223],[421.1318386656364,-130.5388834865823],[422.11583809249623,-129.68055789956597],[423.2907916809965,-128.88622178052572],[424.2343136201885,-128.26264718121413],[425.01011676651524,-127.80808222858866],[425.72229926024323,-127.40081784811265],[426.09498719908953,-127.19050087915957],[427.7459892359479,-127.95210463345703],[429.731691227782,-128.90392491864014],[431.09999627787573,-129.5106262144364],[433.0797972236717,-130.44529658457117],[434.96425939441394,-131.2969834947946],[436.681002772291,-132.16074910862736],[438.4009732847201,-132.89192559429063],[440.3390980928717,-133.78270693451674],[442.16823795700645,-134.64425965608518],[443.5035340308243,-135.27650141676529],[443.1635784567208,-135.4836834550106],[442.42013885975956,-135.99689005264008],[441.8980806930728,-136.35104501877285],[441.3012452086216,-136.77379964509896],[440.6766563670222,-137.2352798860504],[439.7313825547876,-137.9514271450853],[438.13127704000823,-137.19987360982154],[437.858814679966,-137.4337947629272],[437.800449646495,-139.37892706324908],[437.63605948982206,-142.80957943606543],[437.49303023541006,-144.64448014756184],[436.2808092002589,-144.9805668260905],[436.24286048178635,-146.73518729090273]]]}},{type:"Feature",id:"23609",properties:{name:"体育馆"},geometry:{type:"Polygon",coordinates:[[[435.85899229302856,-157.10287852086742],[436.3944624396141,-144.95833392067374],[437.5202177492964,-144.75397105147934],[437.92508110670514,-137.4811076658483],[438.1265257324923,-137.3541640776339],[440.2317808587419,-138.16311831625515],[440.60025200424866,-137.7908706204567],[441.27676949059486,-136.9103335876699],[441.83612808720966,-136.46641726701748],[442.3327444505691,-136.09176631194248],[443.16513046713663,-135.5203055882565],[444.3662451212763,-134.61616511614653],[444.92259964379537,-134.35781474391842],[445.0115202370274,-131.9482898271211],[445.2440355720327,-131.83834071521937],[446.93266853655626,-133.43968386959145],[447.7459143095999,-133.05559153878718],[448.3408068112322,-132.88281436294162],[448.93801674145254,-132.7155303511567],[449.78241905440274,-132.4834441695936],[450.33345207423815,-132.3448276077503],[452.26232513572734,-132.01746936201008],[452.9506014263909,-131.93970675827632],[454.55082878181315,-131.81430812245395],[455.87965950036323,-131.75371165640976],[455.93021377585904,-129.69909663634442],[456.1907957459868,-129.71737857298382],[456.34975418099225,-131.6969775713457],[456.96945175158595,-131.73482890495123],[457.4820326229967,-131.72281260856852],[458.0019091029255,-131.72281260856852],[458.4870241540329,-131.72281260856852],[458.80931838915467,-131.7289065874483],[459.23332199008723,-131.7776584184867],[459.49313148401893,-131.71671862968873],[459.97180923349276,-131.8638324296884],[460.4481695543785,-131.935243562477],[461.2091444381574,-132.1476745163855],[461.99689849673206,-132.21041674964093],[462.859067762191,-132.36817355500813],[463.47653373488504,-132.4806975875633],[463.8498972296333,-132.64317508079515],[464.46865066265406,-132.86633487075963],[465.0258634920577,-133.0101012739098],[465.3919313782879,-133.1371306928127],[467.0133589137568,-131.493129686282],[467.3381422388436,-131.6915702379735],[467.42629035587953,-133.969087555938],[467.8714941368587,-134.26897998137488],[468.64929183557337,-134.6625136879084],[469.1156099659107,-134.95734210272687],[469.98670562296826,-135.42846675161726],[470.45190795435576,-135.9068011783373],[471.0799311017289,-136.41165728778773],[471.7654608103621,-136.9640635986383],[472.10723861176155,-137.31459613025942],[472.47828467792175,-137.7103614346926],[474.8159693084882,-137.0705794830021],[474.9518392883012,-137.26438517751743],[475.3514669737145,-144.2740916723673],[476.7130850152517,-144.44626803339366],[477.38273604652204,-156.3639449550702],[477.3216245963472,-156.58349985611986],[476.62665351198467,-156.57165522111404],[476.1962126094185,-157.59364122846299],[475.5517958005519,-158.74428743779526],[474.436683496237,-160.2503585279902],[473.2431219426808,-161.55249590243298],[472.32344611596176,-162.37492555914056],[471.2097929333505,-163.4556197573878],[470.0164888718597,-164.5103930877238],[467.22304328563496,-165.23222917757045],[464.63335975378556,-165.77682489577225],[462.29267104912344,-166.49205202260842],[460.35976394527717,-166.74525255352967],[458.34780677737047,-166.81177133707678],[456.95872291552996,-166.81331628946884],[455.6593321231175,-166.72010416181445],[452.45664581437336,-166.37111658258536],[451.53774246385035,-166.242456380602],[450.2031610891743,-166.40768045586415],[448.303212969692,-165.6440448207434],[446.92520126666136,-165.15326494419844],[445.1105688514962,-164.67621797780512],[443.47497925243346,-163.78993028889232],[442.1067522478858,-163.09178346905728],[441.1782358602567,-162.4260806494555],[440.5289267021485,-161.705617850624],[439.56135735127555,-160.6237220227385],[439.0835379086862,-159.43290705121257],[438.89359459515106,-158.8288306659164],[438.4736250365756,-158.17102426965184],[437.9312609162734,-157.23186487665515],[437.48820290250546,-156.8110370111952]]]}}]},S=new ol.source.Vector({features:(new ol.format.GeoJSON).readFeatures(f)}),F=new ol.layer.Vector({source:S,style:d}),v=document.getElementsByClassName("chartsContainer")[0],P=new ol.Map({target:"map",layers:[g,F],view:new ol.View({center:[641.5850830105265,-305.29083252082273],resolutions:u,zoom:2,minZoom:1,maxZoom:3,extent:y})}),h=new ol.layer.Vector({source:new ol.source.Vector,map:P,style:w});P.on("pointermove",function(e){var t=P.forEachFeatureAtPixel(e.pixel,function(e,t){return e});t!==s&&(s&&h.getSource().removeFeature(s),t&&h.getSource().addFeature(t),s=t)}),p.arr=[];Boolean;P.on("click",function(e){var t=P.forEachFeatureAtPixel(e.pixel,function(e,t){return e});t?(v.innerHTML="<p>"+t.getId()+"</p><p>"+t.getProperties().name+"</p>",v.style.left="0"):v.style.left="-400px",p.arr.push(String("["+e.coordinate+"]"))}),p.console=function(){console.log(String(p.arr)),p.arr=[]}}]});