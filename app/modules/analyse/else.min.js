angular.module("app").component("else",{templateUrl:"app/modules/analyse/else.html?rev=e6f4b2fc93",controller:["$api","$scope","$state","$q","$stateParams","$rootScope",function(e,a,t,o,r,s){var E=this;E.startDate=String(0==(new Date).getMonth()?(new Date).getFullYear()-1:(new Date).getFullYear())+(0==(new Date).getMonth()?"12":1==String((new Date).getMonth()).length&&"0"+String((new Date).getMonth())||String((new Date).getMonth()))+String((new Date).getDate()),E.endDate=function(e){var a=new Date;a.setDate(a.getDate()+e);var t=a.getFullYear(),o=a.getMonth()+1,r=a.getDate();return String(t)+String(o<10&&"0"+o||o)+String(r)}(0),E.more=[{key:"HOTWATERMETER",title:"热水表",unit:"m3"},{key:"TEMPERATURECONTROL",title:"温控器",unit:"m3"},{key:"TTYPETEMPCONTROL",title:"T型温控器",unit:"m3"},{key:"DDWATERMETER",title:"直饮水表",unit:"m3"},{key:"ULTRACOLDWATERMETER",title:"超声波水表",unit:"m3"},{key:"PRESSUREMETER",title:"压力表",unit:"Pa"},{key:"OXYGENMETER",title:"氧气表",unit:"m3"}],E.analyseType=[{title:"分项能耗",key:"BYITEM",href:'dashboard.else({datatype:"BYITEM"})'},{title:"区域能耗",key:"CUSTOMER",href:'dashboard.else({datatype:"CUSTOMER"})'},{title:"部门能耗",key:"BYAPART",href:'dashboard.else({datatype:"BYAPART"})'}],E.gridOptions={onRegisterApi:function(e){self.gridApi=e},rowHeight:34,infiniteScrollDown:!0,enableColumnMenus:!1,enableColumnResizing:!0,exporterOlderExcelCompatibility:!0,exporterFieldCallback:function(e,a,t,o){return{name:!0,addr:!0,title:!0,time:!0}[t.field]?'="'+(o||"")+'"':o}},E.columnDefsData=function(){E.gridOptions.columnDefs=[{displayName:"类别",name:"name",type:"string",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"01",name:"hour0",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"02",name:"hour1",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"03",name:"hour2",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"04",name:"hour3",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"05",name:"hour4",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"06",name:"hour5",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"07",name:"hour6",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"08",name:"hour8",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"09",name:"hour9",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"10",name:"hour10",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"11",name:"hour11",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"12",name:"hour12",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"13",name:"hour13",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"14",name:"hour14",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"15",name:"hour15",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"16",name:"hour16",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"17",name:"hour17",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"18",name:"hour18",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"19",name:"hour19",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"20",name:"hour20",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"21",name:"hour21",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"22",name:"hour22",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"23",name:"hour23",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"24",name:"hour24",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"25",name:"hour25",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"26",name:"hour26",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"27",name:"hour27",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"28",name:"hour28",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"29",name:"hour29",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"30",name:"hour30",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"},{displayName:"31",name:"hour31",type:"number",minWidth:120,enableColumnMenu:!0,enableSorting:!0,cellClass:"pt5"}]},E.getpie=function(a,t,o){e.eca.analysis({nodes:E.itemArray,projectid:APP.Project[0]._id,timefrom:E.startDate,timeto:E.endDate,devicetype:a,detail:!0,timetype:"MONTH"},function(e){E.piedata={},E.gridOptions.data=[],E.pieunit={title:"总"+o,unit:t},a&&angular.forEach(e.result,function(e){var a={},t=0;a.name=e.title,null!=!e.data.usage&&angular.equals({},e.data.usage)||(angular.forEach(e.data.usage,function(e){a["hour"+t]=angular.isDefined(e.value)&&e.value||"-",t++}),E.gridOptions.data.push(a),E.piedata[e.title]=e.data.usagesum||0)}),!a&&angular.forEach(e.result,function(e){var a={},t=0;a.name=e.title,null!=!e.data.cost&&angular.equals({},e.data.cost)||(angular.forEach(e.data.cost,function(e){a["hour"+t]=angular.isDefined(e.cost)&&e.cost||"-",t++}),E.gridOptions.data.push(a),E.piedata[e.title]=e.data.costsum||0)}),E.columnDefsData()})},e.eca.info({projectid:APP.Project[0]._id,type:r.datatype},function(e){var a=e.result;E.itemArray=[],angular.forEach(a,function(e){E.itemArray.push(e.id)})}).$promise.then(function(){E.getpie(void 0,void 0,"BYITEM"==r.datatype&&"分项能耗"||"CUSTOMER"==r.datatype&&"区域能耗"||"BYAPART"==r.datatype&&"部门能耗")}),E.getdevicedata=function(e,a,t){E.unit=a,E.title=t,E.chartdata=E[e].usage,"hotcloddata"===e?(E.device=["TIMERMETER","HEATENERGYMETER","ENERGYMETER"],E.getpie(["TIMERMETER","HEATENERGYMETER","ENERGYMETER"],a,t)):(E.device=e,E.unit=a,E.title=t,E.getpie(e,a,t)),E.chartTitle=t},E.gettimedata=function(){E.initialize(),E.getpie(void 0,E.unit,E.title)},a.$watch("$ctrl.customerSelected",function(a){e.eca.info({projectid:APP.Project[0]._id,type:r.datatype||"BYCATEGORY"},function(e){var a=e.result;E.categoryArray=[],angular.forEach(a,function(e){E.categoryArray.push(e.id)})}).$promise.then(function(){E.device=void 0,E.unit=void 0,E.title="BYITEM"==r.datatype&&"分项能耗"||"CUSTOMER"==r.datatype&&"区域能耗"||"BYAPART"==r.datatype&&"部门能耗",E.initialize=function(t){E.category={},E.elsedata={},E.elsedatacost={},E.elsedatasum={},e.eca.analysis({nodes:a&&[a]||E.categoryArray,projectid:APP.Project[0]._id,timefrom:E.startDate,timeto:E.endDate,detail:!0,timetype:"MONTH"},function(e){angular.forEach(e.result,function(e){E.elsedata[e.category+"usage"]=e.data.usage,E.elsedata[e.category+"usage"].name=e.title,E.elsedatacost[e.category+"cost"]=e.data.cost,E.elsedatasum[e.category+"usagesum"]=e.data.usagesum,E.elsedatacost[e.category+"costsum"]=e.data.costsum}),E.chartdata=E.elsedata})},E.initialize()})}),s.tips||e.eca.info({projectid:APP.Project[0]._id,type:"BYCATEGORY"},function(e){var a=e.result;E.categoryArray=[],angular.forEach(a,function(e){E.categoryArray.push(e.id)})}).$promise.then(function(){var a=[];E.ELECTRICITYMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.COLDWATERMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.HOTWATERMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.HEATENERGYMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.TEMPERATURECONTROL={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.TIMERMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.PRESSUREMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.ULTRACOLDWATERMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.DDWATERMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.ENERGYMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.TTYPETEMPCONTROL={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.OXYGENMETER={cost:{today:{},yesterday:{},beforeyesterday:{}},usage:{today:{},yesterday:{},beforeyesterday:{}}},E.category={},a.push(e.eca.analysis({nodes:E.categoryArray,projectid:APP.Project[0]._id,timefrom:firsttime,timeto:firsttime,detail:!0,timetype:"DAY"},function(e){angular.forEach(e.result,function(e){"ELECTRICITYMETER"==e.category?(E.ELECTRICITYMETER.usage.today=e.data.usage,E.ELECTRICITYMETER.cost.today=e.data.cost):"COLDWATERMETER"==e.category?(E.COLDWATERMETER.usage.today=e.data.usage,E.COLDWATERMETER.cost.today=e.data.cost):"HOTWATERMETER"==e.category?(E.HOTWATERMETER.usage.today=e.data.usage,E.HOTWATERMETER.cost.today=e.data.cost):"HEATENERGYMETER"==e.category?(E.HEATENERGYMETER.usage.today=e.data.usage,E.HEATENERGYMETER.cost.today=e.data.cost):"TEMPERATURECONTROL"==e.category?(E.TEMPERATURECONTROL.usage.today=e.data.usage,E.TEMPERATURECONTROL.cost.today=e.data.cost):"TIMERMETER"==e.category?(E.TIMERMETER.usage.today=e.data.usage,E.TIMERMETER.cost.today=e.data.cost):"PRESSUREMETER"==e.category?(E.PRESSUREMETER.usage.today=e.data.usage,E.PRESSUREMETER.cost.today=e.data.cost):"ULTRACOLDWATERMETER"==e.category?(E.ULTRACOLDWATERMETER.usage.today=e.data.usage,E.ULTRACOLDWATERMETER.cost.today=e.data.cost):"DDWATERMETER"==e.category?(E.DDWATERMETER.usage.today=e.data.usage,E.DDWATERMETER.cost.today=e.data.cost):"ENERGYMETER"==e.category?(E.ENERGYMETER.usage.today=e.data.usage,E.ENERGYMETER.cost.today=e.data.cost):"TTYPETEMPCONTROL"==e.category?(E.TTYPETEMPCONTROL.usage.today=e.data.usage,E.TTYPETEMPCONTROL.cost.today=e.data.cost):"OXYGENMETER"==e.category&&(E.OXYGENMETER.usage.today=e.data.usage,E.OXYGENMETER.cost.today=e.data.cost),!E.category[e.category]&&(E.category[e.category]={}),E.category[e.category].today=e.data.usagesum,E.category[e.category].todaycost=e.data.costsum})}).$promise),a.push(e.eca.analysis({nodes:E.categoryArray,projectid:APP.Project[0]._id,timefrom:secondtime,timeto:secondtime,detail:!0,timetype:"DAY"},function(e){angular.forEach(e.result,function(e){"ELECTRICITYMETER"==e.category?(E.ELECTRICITYMETER.usage.yesterday=e.data.usage,E.ELECTRICITYMETER.cost.yesterday=e.data.cost):"COLDWATERMETER"==e.category?(E.COLDWATERMETER.usage.yesterday=e.data.usage,E.COLDWATERMETER.cost.yesterday=e.data.cost):"HOTWATERMETER"==e.category?(E.HOTWATERMETER.usage.yesterday=e.data.usage,E.HOTWATERMETER.cost.yesterday=e.data.cost):"HEATENERGYMETER"==e.category?(E.HEATENERGYMETER.usage.yesterday=e.data.usage,E.HEATENERGYMETER.cost.yesterday=e.data.cost):"TEMPERATURECONTROL"==e.category?(E.TEMPERATURECONTROL.usage.yesterday=e.data.usage,E.TEMPERATURECONTROL.cost.yesterday=e.data.cost):"TIMERMETER"==e.category?(E.TIMERMETER.usage.yesterday=e.data.usage,E.TIMERMETER.cost.yesterday=e.data.cost):"PRESSUREMETER"==e.category?(E.PRESSUREMETER.usage.yesterday=e.data.usage,E.PRESSUREMETER.cost.yesterday=e.data.cost):"ULTRACOLDWATERMETER"==e.category?(E.ULTRACOLDWATERMETER.usage.yesterday=e.data.usage,E.ULTRACOLDWATERMETER.cost.yesterday=e.data.cost):"DDWATERMETER"==e.category?(E.DDWATERMETER.usage.yesterday=e.data.usage,E.DDWATERMETER.cost.yesterday=e.data.cost):"ENERGYMETER"==e.category?(E.ENERGYMETER.usage.yesterday=e.data.usage,E.ENERGYMETER.cost.yesterday=e.data.cost):"TTYPETEMPCONTROL"==e.category?(E.TTYPETEMPCONTROL.usage.yesterday=e.data.usage,E.TTYPETEMPCONTROL.cost.yesterday=e.data.cost):"OXYGENMETER"==e.category&&(E.OXYGENMETER.usage.yesterday=e.data.usage,E.OXYGENMETER.cost.yesterday=e.data.cost),!E.category[e.category]&&(E.category[e.category]={}),E.category[e.category].yesterday=e.data.usagesum,E.category[e.category].yesterdaycost=e.data.costsum})}).$promise),a.push(e.eca.analysis({nodes:E.categoryArray,projectid:APP.Project[0]._id,timefrom:thirdtime,timeto:thirdtime,detail:!0,timetype:"DAY"},function(e){angular.forEach(e.result,function(e){"ELECTRICITYMETER"==e.category?(E.ELECTRICITYMETER.usage.beforeyesterday=e.data.usage,E.ELECTRICITYMETER.cost.beforeyesterday=e.data.cost):"COLDWATERMETER"==e.category?(E.COLDWATERMETER.usage.beforeyesterday=e.data.usage,E.COLDWATERMETER.cost.beforeyesterday=e.data.cost):"HOTWATERMETER"==e.category?(E.HOTWATERMETER.usage.beforeyesterday=e.data.usage,E.HOTWATERMETER.cost.beforeyesterday=e.data.cost):"HEATENERGYMETER"==e.category?(E.HEATENERGYMETER.usage.beforeyesterday=e.data.usage,E.HEATENERGYMETER.cost.beforeyesterday=e.data.cost):"TEMPERATURECONTROL"==e.category?(E.TEMPERATURECONTROL.usage.beforeyesterday=e.data.usage,E.TEMPERATURECONTROL.cost.beforeyesterday=e.data.cost):"TIMERMETER"==e.category?(E.TIMERMETER.usage.beforeyesterday=e.data.usage,E.TIMERMETER.cost.beforeyesterday=e.data.cost):"PRESSUREMETER"==e.category?(E.PRESSUREMETER.usage.beforeyesterday=e.data.usage,E.PRESSUREMETER.cost.beforeyesterday=e.data.cost):"ULTRACOLDWATERMETER"==e.category?(E.ULTRACOLDWATERMETER.usage.beforeyesterday=e.data.usage,E.ULTRACOLDWATERMETER.cost.beforeyesterday=e.data.cost):"DDWATERMETER"==e.category?(E.DDWATERMETER.usage.beforeyesterday=e.data.usage,E.DDWATERMETER.cost.beforeyesterday=e.data.cost):"ENERGYMETER"==e.category?(E.ENERGYMETER.usage.beforeyesterday=e.data.usage,E.ENERGYMETER.cost.beforeyesterday=e.data.cost):"TTYPETEMPCONTROL"==e.category?(E.TTYPETEMPCONTROL.usage.beforeyesterday=e.data.usage,E.TTYPETEMPCONTROL.cost.beforeyesterday=e.data.cost):"OXYGENMETER"==e.category&&(E.OXYGENMETER.usage.beforeyesterday=e.data.usage,E.OXYGENMETER.cost.beforeyesterday=e.data.cost),!E.category[e.category]&&(E.category[e.category]={}),E.category[e.category].beforeyesterday=e.data.usagesum,E.category[e.category].beforeyesterdaycost=e.data.costsum})}).$promise),o.all(a).then(function(){E.chartdata=E.ELECTRICITYMETER.usage,E.unit="kwh",E.chartTitle="耗电量",E.coldhot={},E.hotcloddata={usage:{today:{},yesterday:{},beforeyesterday:{}},cost:{today:{},yesterday:{},beforeyesterday:{}}},E.fee={today:{},yesterday:{},beforeyesterday:{}},angular.forEach(E.category,function(e){E.todaycost=new BigDecimal(String(e.todaycost)).add(new BigDecimal(String(E.todaycost||0))).setScale(2,MathContext.ROUND_HALF_UP).toString(),E.yesterdaycost=new BigDecimal(String(e.yesterdaycost)).add(new BigDecimal(String(E.yesterdaycost||0))).setScale(2,MathContext.ROUND_HALF_UP).toString(),E.beforeyesterdaycost=new BigDecimal(String(e.beforeyesterdaycost)).add(new BigDecimal(String(E.beforeyesterdaycost||0))).setScale(2,MathContext.ROUND_HALF_UP).toString(),E.coldhot.today=new BigDecimal(String(E.category.HEATENERGYMETER&&E.category.HEATENERGYMETER.today||0)).add(new BigDecimal(String(E.category.ENERGYMETER&&E.category.ENERGYMETER.today||0))).setScale(2,MathContext.ROUND_HALF_UP).toString(),E.coldhot.yesterday=new BigDecimal(String(E.category.HEATENERGYMETER&&E.category.HEATENERGYMETER.yesterday||0)).add(new BigDecimal(String(E.category.ENERGYMETER&&E.category.ENERGYMETER.yesterday||0))).setScale(2,MathContext.ROUND_HALF_UP).toString(),E.coldhot.beforeyesterday=new BigDecimal(String(E.category.HEATENERGYMETER&&E.category.HEATENERGYMETER.beforeyesterday||0)).add(new BigDecimal(String(E.category.ENERGYMETER&&E.category.ENERGYMETER.beforeyesterday||0))).setScale(2,MathContext.ROUND_HALF_UP).toString()}),angular.forEach(!angular.equals({},E.TIMERMETER.usage.today)&&E.TIMERMETER.usage||!angular.equals({},E.HEATENERGYMETER.usage.today)&&E.HEATENERGYMETER.usage||!angular.equals({},E.ENERGYMETER.usage.today)&&E.ENERGYMETER.usage,function(e,a){"beforeyesterday"==a&&angular.forEach(e,function(e,a){E.hotcloddata.usage.beforeyesterday[a]={},E.hotcloddata.usage.beforeyesterday[a].timepoint=Number(a),E.hotcloddata.usage.beforeyesterday[a].value=Number(new BigDecimal(String(!angular.equals({},E.TIMERMETER.usage.beforeyesterday)&&E.TIMERMETER.usage.beforeyesterday[a].value||0)).add(new BigDecimal(String(!angular.equals({},E.HEATENERGYMETER.usage.beforeyesterday)&&E.HEATENERGYMETER.usage.beforeyesterday[a].value||0))).add(new BigDecimal(String(!angular.equals({},E.ENERGYMETER.usage.beforeyesterday)&&E.ENERGYMETER.usage.beforeyesterday[a].value||0))).setScale(2,MathContext.ROUND_HALF_UP).toString())})}),angular.forEach(E,function(e){angular.equals({},e.cost)||angular.forEach(e.cost,function(e,a){"today"==a&&angular.forEach(e,function(e,a){!E.fee.today[a]&&(E.fee.today[a]={}),E.fee.today[a].timepoint=Number(a),E.fee.today[a].value=Number(new BigDecimal(String(E.fee.today[a].value||0)).add(new BigDecimal(String(e.cost))).toString())}),"yesterday"==a&&angular.forEach(e,function(e,a){!E.fee.yesterday[a]&&(E.fee.yesterday[a]={}),E.fee.yesterday[a].timepoint=Number(a),E.fee.yesterday[a].value=Number(new BigDecimal(String(E.fee.yesterday[a].value||0)).add(new BigDecimal(String(e.cost))).toString())}),"beforeyesterday"==a&&angular.forEach(e,function(e,a){!E.fee.beforeyesterday[a]&&(E.fee.beforeyesterday[a]={}),E.fee.beforeyesterday[a].timepoint=Number(a),E.fee.beforeyesterday[a].value=Number(new BigDecimal(String(E.fee.beforeyesterday[a].value||0)).add(new BigDecimal(String(e.cost))).toString())})})}),s.tips={todayELECTRICITYMETER:E.category.ELECTRICITYMETER.today,yesterdayELECTRICITYMETER:E.category.ELECTRICITYMETER.yesterday,beforeyesterdayELECTRICITYMETER:E.category.ELECTRICITYMETER.beforeyesterday,todayCOLDWATERMETER:E.category.COLDWATERMETER.today,yesterdayCOLDWATERMETER:E.category.COLDWATERMETER.yesterday,beforeyesterdayCOLDWATERMETER:E.category.COLDWATERMETER.beforeyesterday,todaycoldhot:E.coldhot.today,yesterdaycoldhot:E.coldhot.today.yesterday,beforeyesterdaycoldhot:E.coldhot.today.beforeyesterday,todaycost:E.todaycost,yesterdaycost:E.yesterdaycost,beforeyesterdaycost:E.beforeyesterdaycost}})})}]}),angular.module("app").component("pile",{templateUrl:"app/modules/analyse/ele.html?rev=e179134e6e",bindings:{data:"=",unit:"<",chartTitle:"<"},controller:["$scope","$rootScope","$api",function(e,a,t){var o=this;e.$watchCollection(function(){return o.data},function(e){var a=[],t=[];o.charttype="column",angular.forEach(o.data,function(e,r,s){var E=[];o.key=r,Object.keys(e).length>a.length&&(s=0,a=[]),angular.forEach(e,function(e){e.value&&this.push(e.value),0===s&&a.push(parseInt(e.timepoint))},E),t.push({data:E,name:e.name});var y=["#24CBE5","#FF9655","#FFF263","#6AF9C4","#64E572"];angular.forEach(y,function(e,a){t[a]&&(t[a].color=e)})}),o.typeChange=function(e){e&&(o.charttype=e),"column"==o.charttype?o.energyconstitute={chart:{type:"column",backgroundColor:"rgba(0, 0, 0, 0)"},title:{text:""},xAxis:{categories:a,labels:{formatter:function(){return Number(String(moment(this.value).year())+String(moment(this.value).month()+1)+String(moment(this.value).date()))},style:{color:"#fff"}}},yAxis:{min:0,stackLabels:{enabled:!0,style:{fontWeight:"bold",color:"white"}}},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y+"<br/>总量: "+this.point.stackTotal}},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!0,color:"white",style:{textShadow:"0 0 3px black"}}}},series:t}:o.energyconstitute={chart:{type:o.charttype,backgroundColor:"rgba(0, 0, 0, 0)"},title:!1,xAxis:{categories:a,labels:{formatter:function(){return Number(String(moment(this.value).year())+String(moment(this.value).month()+1)+String(moment(this.value).date()))},style:{color:"#fff"}}},yAxis:{title:!1},tooltip:{xDateFormat:String(moment(this.value).year())+String(moment(this.value).month()+1)+String(moment(this.value).date()),pointFormat:'{series.name}: <span style="color:{point.color};font-weight:700;">{point.y} '+o.unit+"</span>"},series:t}},o.typeChange()})}]});